{% extends "template.html" %}

{% block content %}
<pre>
    int main(int argc, char* argv[])
    {
        // Set up logging
        UniValue loggerSettings(UniValue::VOBJ);
        loggerSettings.push_back(Pair("level", "info"));
        loggerSettings.push_back(Pair("max-size", "1000"));
        loggerSettings.push_back(Pair("max-threads", "16"));
        loggerSettings.push_back(Pair("filename", "debug.log"));
        loggerSettings.push_back(Pair("append", "true"));
        loggerSettings.push_back(Pair("rotate", "true"));
        loggerSettings.push_back(Pair("count", "10"));
        loggerSettings.push_back(Pair("keep-days", "30"));
        loggerSettings.push_back(Pair("keep-forever", "true"));
        loggerSettings.push_back(Pair("suppress-verbose", "true"));
        loggerSettings.push_back(Pair("suppress-debug", "true"));
        loggerSettings.push_back(Pair("suppress-info", "true"));
        loggerSettings.push_back(Pair("suppress-warn", "true"));
        loggerSettings.push_back(Pair("suppress-error", "false"));
        loggerSettings.push_back(Pair("suppress-fatal", "false"));
    
        // Set up network settings
        SetNetworkParams();
    
        // Genesis block
        const CBlock& genesis = *(const CBlock*)chainActive.GetBlockByHeight(0);
        printf("Genesis block: %s\n", genesis.GetHash().ToString());
    
        // Initialize the transaction cache
        txCache = new CTransactionCache();
    
        // Set up the initial chain state
        if (!ReadInitialBlockDownload()) {
            chainActive.SetBestBlock(GetInitialBlockDownload());
        }
        chainActive.SetBestBlock(GetBestBlock());
        if (!CheckForkRequirements(
                CChainParams::REGTEST,
                consensus.nDefaultConsensus, 
                consensus.nForkHeight, 
                consensus.nForkBlock, 
                consensus.nForkTime
                )
            ) {
            return false;
        }
    
        // Set up the BIP 22 check
        if (!CheckBIP22Compatibility()) {
            return false;
        }
    
        // Set up the initial UI state
        if (!uiInterface.Init(argc, argv)) {
            return false;
        }
    
        // Load the wallet
        if (!LoadWallet()) {
            return false;
        }
    
        // Set up the RPC server
        if (!RPCSetup()) {
            return false;
        }
    
        // Set up the initial RPC state
        if (!SetupRPCConnections()) {
            return false;
        }
    
        // Initialize the scheduler
        scheduler.reset(new CScheduler());
    
        // Set up the network daemon
        if (!SetupDaemon()) {
            return false;
        }
    
        // Initialize the logging subsystem
        logging.init(argc, argv, loggerSettings);
    
        // Run the Bitcoin network
        bool fRunning = true;
        while (fRunning) {
            int nRet = Run();
            if (nRet == false) {
                fRunning = false;
            } else if (nRet == 0) {
                break;
            } else if (nRet < 0) {
                return false;
            }
        }
    
        // Clean up the logging subsystem
        logging.fatal("Shutdown completed; exiting.");
        logging.DeInit();
    
        // Clean up the RPC server
        RPCShutdown();
    
        // Clean up the wallet
        UnloadWallet();
    
        // Clean up the UI
        uiInterface.Shutdown();
    
        // Clean up the network daemon
        ShutdownDaemon();
    
        // Clean up the scheduler
        scheduler.reset();
    
        return true;
    </pre>
{% endblock %}
